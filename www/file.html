<html>
	<head>
		<meta charset="utf-8">
		<style>
.header_css{
	background-image:url('ass/head.png');
	height:8%;
}
.list_css{
	background-color:#FFFFF;
	height:88%;
	width:70%;
	float:left;
}
.user_act_css{
	background-color:#EEEEEE;
	height:88%;
	width:30%;
	float:left;
}
.footer_css{
	background-color:#F8F8F8 ;
	clear:both;
	text-align:center;
	height:4%;
}
		</style>
		<script src="ejs.js"></script>
	</head>
	<body>
		<div id="header" class="header_css">
		<h1 style="margin-bottom:0;">后台文件操作</h1></div>

		<div id="list" class="list_css">
		<%= dirlist %>
		</div>

		<div id="content" class="user_act_css">
			<hr/>
			<div id="login_ui">
				<form id="loginform">
					用户:<input type="text" name="user"><br>
					密码:<input type="text" name="passwd"><br>
					<input type="submit" value="提交">
				</form>
				<hr/>
			</div>
			<div>
				<input type="file" name="file" id="uploadfile"/>
				<input type="button" onclick="uploadfile()" value="上传" />
				<hr/>
			</div>
		</div>

		<div id="footer" class="footer_css">
			<progress id="file" max="100" />
		</div>
		
		<script>
function login(){
	const formData = new FormData(loginform);
	var xhr = new XMLHttpRequest();

	xhr.addEventListener("load", (event) => {
	serval = JSON.parse(event.target.responseText);
		if ( serval.login == 0 ) {
			alert("登录成功\nID:"+serval.loginUUID);
			location.href = "/?loginUUID=" + serval.loginUUID;
		}
		if ( serval.login == 1 ) alert("登录失败\n" + serval.msg);
	});
	xhr.addEventListener("error", (event) => {alert("哎呀！出了一些问题。");});
    xhr.open("POST", "/login");
    xhr.send(formData);
}
const loginform = document.getElementById("loginform");
loginform.addEventListener('submit', (event) => {
	// 阻止表单的默认提交行为
	event.preventDefault();
	login();
});
		</script>
	</body>
</html>